<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;

class ItemSeeder extends Seeder
{
    public function run(): void
    {
        $tsv = <<<TSV
CLS/C/EXCEL ANDRS 198-5 HICKORY PLANK8X194X1215/1.	FLOORING AND WALL	BOX	0	0%
CLS/C/EXCEL ANDRS FR618 RUSTIC WLNUT 8X194X1215/1.	FLOORING AND WALL	BOX	0	0%
CLS/C/GOLDEN STONE ONYX MOSAIC TILE 32X32CM	FLOORING AND WALL	PCS	0	0%
CLS/C/JUTOP K 1890 B SOLIDWOOD BROWN 18X90X900M	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP WOOD 1668-MAPLE APPA HDF LMNT/8PCS	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP WOOD 175 MERBAU (NON FINISHING)	FLOORING AND WALL	BOX	0	0%
CLS/C/INTERWOOD CHERRY-3STRIP 1283X193X8 (1BOX=1.9	FLOORING AND WALL	BOX	0	0%
CLS/C/INTERWOOD ELEGENT MAPLE 1283X193X8(1 BOX=1.9	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP WOOD 3365 PLANKHDF 8X195X1215MM/1.8954	FLOORING AND WALL	BOX	0	0%
CLS/C/INTERWOOD SKRT PROFILE/PLINT 10CM(2.4M/BTG)W	FLOORING AND WALL	PCS	0	0%
STP/C/INTERWOOD TRANSITION PROFILE (2.4M/BATANG)	FLOORING AND WALL	PCS	0	0%
CLS/C/INTERWOOD MAPLE 1283MMX193MMX8MM (1BOX=1.980	FLOORING AND WALL	BOX	0	0%
STP/C/JUTOP WOOD SKIRTING A12 12X100X2400MM	FLOORING AND WALL	PCS	0	0%
CLS/C/ZEBRANO RED ALDER  1215X197X8.3(1 BOX=2.39M2	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP WOOD WALL PANEL 8X136X2400MM	FLOORING AND WALL	PCS	0	0%
CLS/C/JUTOP MF 116 VALLEY PLUM 8X192X1288(1=1.98 M	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP WOOD SKIRTINGA1210 12X100X2400MM CHERY	FLOORING AND WALL	BOX	0	0%
C/LG VINYL CALEO PALACE 082-5 1.5MMX2MX1M	FLOORING AND WALL	MTR	0	0%
CLS C/LG VINYL CALEO PALACE 083-05 1.5MX2MX2	FLOORING AND WALL	MTR	0	0%
CLS C/LG VINYL CALEO PALACE 7771-05 1.5MX2MX	FLOORING AND WALL	MTR	0	0%
CLS C/LG VINYL DELIGHT 9101-01 UK.2.2MX2MX20	FLOORING AND WALL	MTR	0	0%
C/LG VINYL SUPREME 7773 1.8MMX2MX1M	FLOORING AND WALL	MTR	0	0%
C/LG VINYL SUPREME 9461-02 1.8MMX2MX1M	FLOORING AND WALL	MTR	0	0%
C/LG VINYL CALEO PALACE 7435 1.5MMX2MX1M	FLOORING AND WALL	MTR	0	0%
STP/C/MOZART COMER 201S-WHITE 30X30CM/1.5MM VINYL	FLOORING AND WALL	PCS	0	0%
C/LG VINYL SUPREME 9031-01 1.8MMX2MX1M	FLOORING AND WALL	MTR	0	0%
CLS/C/ROMAN BAZAAR FT.33.3X33.3CM	FLOORING AND WALL	BOX	0	0%
CLS/C/ROMAN BAZAAR WT.20X20CM	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO DESSERT LAND STROM BLACK 30X30CM	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO NAVONA BROWN 30X30CM	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO BAYADERE B02-WALTZ PT 30X30CM	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO-B KW I 242-SARA PT/KTSA 30X30CM	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOPWOODCHERRICR0498X75X1016MM(BOX=1.8288M2	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO SEASONED GKX02PL 60X60/BOX=1.08M2	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO BAYADERE WALTZ PL 60X60CM(1BOX=1.0	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO SOLFEN OCRA PLSH PL 60X60CM(1BOX=1.0	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO SOLFEN PEARL PT  PL 30X30CM(1BOX=1.1	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO SOLFEN PEARL SS 30X60CM(1BOX=1.08M2)	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO SOLFENS01 LATERITE MATT 30X60/BOX=1.	FLOORING AND WALL	BOX	0	0%
CLS/C/ARMANY FRISCO WASH OAK 900X75X8MM(1BOX=3.24M	FLOORING AND WALL	BOX	0	0%
CLS/C/ARMANY FRISCO OAKCAPPUCINO900X75X8MM(1BOX=3.	FLOORING AND WALL	BOX	0	0%
CLS/C/PARADOR PC4885 WENGE BLOCK 1285X192X8(1BOX=1	FLOORING AND WALL	BOX	0	0%
CLS/C/PARADOR END-MOULDING 2400MM-L/PC	FLOORING AND WALL	BOX	0	0%
CLS/C/PERGO T-MOULDING 10X44X2440MM	FLOORING AND WALL	BOX	0	0%
CLS/C/PERGO STAIRNOSE 20X65X2440MM	FLOORING AND WALL	BOX	0	0%
CLS C/NIROFO-A KWII200-BIANC PLS 30X30/BOX=0.81M2	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO DESSERT LAND 701-WHITE SAND 30X30CM	FLOORING AND WALL	BOX	0	0%
CLS/C/PERGO PRACTIQ PAPYRUS1196 X196X9.5MM(BOX=1.8	FLOORING AND WALL	BOX	0	0%
CLS/C/PERGO PRACTIQ BIRCH 1196 X196X9.5MM(BOX=1.88	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO NAVONA C-04 GREY MATT 1ST 45X45CM	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO-B KW II 850ELENA KRANJIROCK 30X30/1.	FLOORING AND WALL	BOX	0	0%
CLS/C/PARADOR CLC NTRL WILD CH1285X192X8(BOX=2.22)	FLOORING AND WALL	BOX	0	0%
STP/C/NIRO FO SEASONED KW I GKX05PL URBAN 45X90/	FLOORING AND WALL	BOX	0	0%
CLS/C/OPTIMA NATURAL GRANITE TAN BROWN PER CM	FLOORING AND WALL	PCS	0	0%
CLS/C/NIRO FO-B KW I 821 ZIRCONE UNPOLISH 30X30/	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO-C KW I 899-BLACK MATT 30X60CM=1.08	FLOORING AND WALL	BOX	0	0%
CLS/C/ELEGANZA AXIS GDA66819 AMBRA 60X60CM/1.44M2	FLOORING AND WALL	BOX	0	0%
STP/C/ELEGANZA 60X60CM/1.44M METRO GDA66827 AVORIO	FLOORING AND WALL	BOX	0	0%
STP/C/ELEGANZA 30X60CM/1.44M2 NTR STN GDC36018OPAL	FLOORING AND WALL	BOX	0	0%
STP/C/OPTIMA ACRYLIC UPR-RX503 LIGHT GREY PER CM	FLOORING AND WALL	CM	0	0%
CLS/C/JUTOP AC 1512R SOLIDWOOD ACACIA 15X80X1200MM	FLOORING AND WALL	BOX	0	0%
CLS/C/ARMSTRONG ARMALOCK CLOUDY IVORY (BOX=1.94M2)	FLOORING AND WALL	BOX	0	0%
STP/C/ELEGANZA 15X60CM/1M2 NANTUCKET QDC6153625 	FLOORING AND WALL	BOX	0	0%
CLS/C/VARNESSE EMSE 03 AMBER HICKORY/BOX=1.9M2	FLOORING AND WALL	BOX	0	0%
STP/C/ELEGANZA 60X60CM/1.44 CNTEMPO GDA66169 SNDMT	FLOORING AND WALL	BOX	0	0%
CLS/C/EXCEL ANDRS 6927 CLASSIC CHERY 8X194X1215/1.	FLOORING AND WALL	BOX	0	0%
CLS/C/GOLDEN STONE TAN MOSAIC PEEBLE 32X32CM	FLOORING AND WALL	PCS	0	0%
CLS/C/JUTOP A 1257 CORNICE 12X57X2400MM	FLOORING AND WALL	PCS	0	0%
CLS/C/JUTOP K 1590 B SOLIDWOOD BROWN 15X90X900M	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP K 1890 N SOLIDWOOD KEMPAS NATURAL 18X9	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP WOOD 1709-MERBAU TASMANIA HDFLMNT/8PCS	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP WOOD 1723-SACRAMENTO PINE HDFLMNT/8PCS	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP WOOD 175-ACACIA P-60/75/90CM/1.8375M2	FLOORING AND WALL	BOX	0	0%
CLS/C/INTERWOOD CHERRY-3STRIP 1283X193X8(1BOX=1980	FLOORING AND WALL	BOX	0	0%
CLS/C/INTERWOOD END PROFILE (2.4M/BATANG)	FLOORING AND WALL	PCS	0	0%
CLS/C/INTERWOOD L  ALUMUNIUM  (/M)	FLOORING AND WALL	PCS	0	0%
CLS/C/JUTOP WOOD 5905-SUNGKAI BRN SOLID WOOD/10PCS	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP WOOD 590-SUNGKAI NTRL SOLID WOOD/10PCS	FLOORING AND WALL	BOX	0	0%
CLS/C/INTERWOOD BEECH 1283MMX193MMX8MM (1BOX=1.980	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP WOOD HDF 3300 8X195X1215MM/1.8954M2	FLOORING AND WALL	BOX	0	0%
STP/C/JUTOP WOOD STAIRNOSE 16X52X2400MM	FLOORING AND WALL	PCS	0	0%
STP/C/JUTOP ARCHITRAVE EDGING 20X45 MM (1BTG=2.4M)	FLOORING AND WALL	PCS	0	0%
STP/C/JUTOP VG 450 VICTORIA ALD 12X137X1285(1=1.	FLOORING AND WALL	BOX	0	0%
CLS C/LG VINYL CALEO PALACE 083-05 1.5MMX2MX	FLOORING AND WALL	MTR	0	0%
CLS C/LG VINYL CALEO PALACE 7772-05 1.5MMX2M	FLOORING AND WALL	MTR	0	0%
STP/C/LG VINYL CALEO PALACE 8332-05 1.5MMX2MX1M	FLOORING AND WALL	MTR	0	0%
CLS C/LG VINYL DELIGHT 91505-01 UK.2.2MX2MX2	FLOORING AND WALL	MTR	0	0%
C/LG VINYL SUPREME 8082 1.8MMX2MX1M	FLOORING AND WALL	MTR	0	0%
CLS/C/LG VINYL SUPREME 8112 1.8MMX2MX1M	FLOORING AND WALL	MTR	0	0%
CLS/C/ROMAN BAZAAR FT 50X50CM	FLOORING AND WALL	BOX	0	0%
CLS/C/ARWANA BAZAAR RIMPILAN	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO NAVONA BEIGE 45X45CM	FLOORING AND WALL	BOX	0	0%
STP/C/NIRO FO-C KW I WHITE UNPOLISHED 30X30CM=1.	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO-B KELLY UNPOLISHED 30X30CM	FLOORING AND WALL	BOX	0	0%
CLS/C/JUTOP SKIRTING/PLANK A1475 14X75X2400 1BTG=1	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO REGAL ROCK GMR82GREY 1ST60X60/BOX=1.	FLOORING AND WALL	BOX	0	0%
CLS C/NIRO FO REGAL ROCK GMR83VANILLA 60X60/	FLOORING AND WALL	BOX	0	0%
CLS/C/NIRO FO SOLFEN OLIVE SS 30X30CM(1BOX=1.17M2)	FLOORING AND WALL	BOX	0	0%
CLS/C/PLATINUM BAZAAR WT 20X33CM	FLOORING AND WALL	BOX	0	0%
TSV;

        $rows = preg_split("/\r\n|\n|\r/", trim($tsv));
        $batch = [];

        foreach ($rows as $line) {
            if (!trim($line))
                continue;
            // Split by TAB (Excel-export friendly)
            $cols = explode("\t", $line);

            // Guard for malformed lines
            if (count($cols) < 5)
                continue;

            [$name, $category, $uom, $priceRaw, $discRaw] = $cols;

            // Normalize numbers: strip anything except digits and dot
            $price = random_int(100000, 10000000);
            $disc = (float) preg_replace('/[^\d.]/', '', $discRaw ?: '0'); // "0%" -> 0

            $batch[] = [
                'item_name' => trim($name),
                'category' => trim($category),
                'uom' => trim($uom) ?: null,
                'price' => $price,
                'disc' => $disc, // store numeric only
                'created_at' => now(),
                'updated_at' => now(),
            ];
        }

        // Insert in chunks (safer for large lists)
        foreach (array_chunk($batch, 500) as $chunk) {
            DB::table('items')->insert($chunk);
        }
    }
}
